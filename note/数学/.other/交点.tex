* 交点
	\Problem
		(input)
			射线方程: $\.x(t) = \.x_0 + t \hat{\.d}$
			曲面方程: $f(\.x) = 0$

		- Answer
			交点: $f(\.x_0 + t \hat{\.d}) = 0$
			求解$t$即可. $t = dis$即射线出发点与交点的距离.

	\Include
		* 射线、平面交点
			(input) 平面方程: $\.a^T \.x = b$
			$
				dis &= \/{\.a^T \.x_0 - b}{\.a^T \hat{\.d}}
					&= \/{(\sum_{i=1}^{\dim} a_i x_{0i}) - b}{\sum_{i=1}^{\dim} a_i d_i}  \tag{分量形式}
			$

			\Proof
				$
				=> \.a^T (\.x_0 + t \hat{\.d}) - b &= 0
					t \.a^T \hat{\.d} + (\.a^T \.x_0 - b) &= 0
					t &= \/{\.a^T \.x_0 - b}{\.a^T \hat{\.d}}
						&= \/{(\sum_{i=1}^{\dim} a_i x_{0i}) - b}{\sum_{i=1}^{\dim} a_i d_i}  \tag{分量形式}
				$

			* 射线、平面图形交点

				* 射线、三角形交点
					(input) 三角形顶点 $\.v_1, \.v_2, \.v_3$
					$
						dis &= \/{(\.x_0 - \.v_1) × \.e_1·\.e_2}{\hat{\.d} × \.e_2·\.e_1}
						u &= \/{\hat{\.d} × \.e_2· (\.x_0 - \.v_1)}{\hat{\.d} × \.e_2·\.e_1}
						v &= \/{(\.x_0 - \.v_1) × \.e_1· \hat{\.d}}{\hat{\.d} × \.e_2·\.e_1}
						\.e_1 &= \.v_2 - \.v_1
						\.e_2 &= \.v_3 - \.v_1
					$
					有交点条件: $u ≥ 0, v ≥ 0, u + v ≤ 1$

					\Proof
						射线三角形交点:
						$
								\.x_0 + t \hat{\.d} &= (1 - u - v) \.v_1 + u \.v_2 + v \.v_3
							=> \.x_0 - \.v_1 &=(\mb -\hat{\.d} & \.v_2 - \.v_1 & \.v_3-\.v_1 \me) (\mb t \\ u \\ v \me) 
									&= (\mb -\hat{\.d} & \.e_1 & \.e_2 \me) (\mb t \\ u \\ v \me)  \tag{$\.e_1 &= \.v_2 - \.v_1, \.e_2 &= \.v_3 - \.v_1$}
						$
						$
							t &= \/{\l|\mb  (\.x_0 - \.v_1) & \.e_1 & \.e_2 \me\r|}{\l|\mb -\hat{\.d} & \.e_1 & \.e_2 \me\r|}
							u &= \/{\l|\mb -\hat{\.d} &  (\.x_0 - \.v_1) & \.e_2 \me\r|}{\l|\mb -\hat{\.d} & \.e_1 & \.e_2 \me\r|}
							v &= \/{\l|\mb -\hat{\.d} & \.e_1 & (\.x_0 - \.v_1) \me\r|}{\l|\mb -\hat{\.d} & \.e_1 & \.e_2 \me\r|}
						$
						$
							|\mb \.a & \.b & \.c \me| &= \.a × \.b · \.c 
								&= -\.a × \.c · \.b  \tag{混合积公式}
							t &= \/{(\.x_0 - \.v_1) × \.e_1·\.e_2}{\hat{\.d} × \.e_2·\.e_1}
							u &= \/{\hat{\.d} × \.e_2· (\.x_0 - \.v_1)}{\hat{\.d} × \.e_2·\.e_1}
							v &= \/{(\.x_0 - \.v_1) × \.e_1· \hat{\.d}}{\hat{\.d} × \.e_2·\.e_1}
						$

				* 射线、圆交点
					\Note
						先与平面计算交点, 再看交点与圆心的距离是否小于半径.

				* 射线、任意平面图案交点
					\Note
						先与平面计算交点, 再看交点是否在图案内部.

		* 射线、球面交点
			(input) 球方程: $||\.x - \.c||_2 - R = 0$
			$
				dis &= \/{-b ± \sqrt{Δ}}{2a}
				Δ &= b^2 - 4 a c
					&= (2 \hat{\.d}^T (\.x_0 - \.c))^2 - 4 (\hat{\.d}^T \hat{\.d}) ((\.x_0 - \.c)^T (\.x_0 - \.c) - R^2)
					&= 4 (\sum_{i=1}^{\dim} d_i (x_{0i} - c_i))^2 - 4 (\sum_{i=1}^{\dim} d_i^2) ((\sum_{i=1}^{\dim} (x_{0i} - c_i)^2) - R^2)  \tag{分量形式}
			$
			若$Δ≥0$有交点; 若$Δ<0$无交点.

			\Proof
				$ 
					=> (\.x - \.c)^T (\.x - \.c) - R^2 &= 0
					=> (\.x_0 + t \hat{\.d} - \.c)^T (\.x_0 + t \hat{\.d} - \.c) - R^2 &= 0  \tag{相交，代入}
					=> t^2 (\hat{\.d}^T \hat{\.d}) + t (2 \hat{\.d}^T (\.x_0 - \.c)) + ((\.x_0 - \.c)^T (\.x_0 - \.c) - R^2) &= 0
				$

				$
					Δ &= b^2 - 4 a c
						&= (2 \hat{\.d}^T (\.x_0 - \.c))^2 - 4 (\hat{\.d}^T \hat{\.d}) ((\.x_0 - \.c)^T (\.x_0 - \.c) - R^2)
						&= 4 (\sum_{i=1}^{\dim} d_i (x_{0i} - c_i))^2 - 4 (\sum_{i=1}^{\dim} d_i^2) ((\sum_{i=1}^{\dim} (x_{0i} - c_i)^2) - R^2)  \tag{分量形式}
				$
				若$Δ≥0$有交点; 若$Δ<0$无交点.
				$t = \/{-b ± \sqrt{Δ}}{2a}$

		* 射线、椭球面交点
			(input) 椭球方程: $(\.x - \.c)^T \.P^{-1} (\.x - \.c) = 1$
			$
				dis &= \/{-b ± \sqrt{Δ}}{2a}
				Δ &= b^2 - 4 a c
					&= (2 \hat{\.d}^T \.P^{-1} (\.x_0 - \.c))^2 - 4 (\hat{\.d}^T \.P^{-1} \hat{\.d}) ((\.x_0 - \.c)^T \.P^{-1} (\.x_0 - \.c) - 1)
			$
			若$Δ≥0$有交点; 若$Δ<0$无交点.

			\Proof
				$
				=> (t \hat{\.d} + (\.x_0 - \.c))^T \.P^{-1} (t \hat{\.d} + (\.x_0 - \.c)) - 1 &= 0
					t^2 (\hat{\.d}^T \.P^{-1} \hat{\.d}) + t (2 \hat{\.d}^T \.P^{-1} (\.x_0 - \.c)) + ((\.x_0 - \.c)^T \.P^{-1} (\.x_0 - \.c) - 1) &= 0
				$

				$
					Δ &= b^2 - 4 a c
						&= (2 \hat{\.d}^T \.P^{-1} (\.x_0 - \.c))^2 - 4 (\hat{\.d}^T \.P^{-1} \hat{\.d}) ((\.x_0 - \.c)^T \.P^{-1} (\.x_0 - \.c) - 1)
				$
				若$Δ≥0$有交点; 若$Δ<0$无交点.
				$t = \/{-b ± \sqrt{Δ}}{2a}$

		* 射线、矩体交点
